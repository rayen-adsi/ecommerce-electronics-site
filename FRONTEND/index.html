<!DOCTYPE html>
<html lang="fr"> <head>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta charset="UTF-8">
    <title>TecHaven - Computer Store</title>
    <link rel="icon" href="images/lo5.png" type="image/png">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="css/styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/lipis/flag-icons@7.3.2/css/flag-icons.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

</head>
<style>
    * {
  font-family: 'Space Grotesk', sans-serif;
}

</style>
<body>
 
    <header class="main-header">
        <a href="index.html" class="logo">
            <img src="images/logo8.png" alt="TechHaven Logo">
        </a>
 
        <div class="search-wrapper">
    <input type="text" id="searchInput" placeholder="Rechercher...">
    <span class="search-icon">ğŸ”</span>
    <!-- ADD THIS DIV FOR SEARCH SUGGESTIONS DROPDOWN -->
    <div id="searchResultsDropdown" class="search-results-dropdown"></div>
</div>
 
        <div id="user-controls">
            <a href="login.html" class="icon-button">
                <span class="icon">ğŸ‘¤</span>
                <span class="text" data-i18n="header.login">Connexion</span>
            </a>
        </div>
 
        <a href="cart.html" class="icon-button cart-button">
            <span class="icon">ğŸ›’</span>
            <span class="badge">0</span>
            <span class="text" data-i18n="header.cart">Mon Panier</span>
        </a>
 
        <div class="icon-button language-button">
            <span class="icon">ğŸŒ</span>
            <select class="language-select">
                <option value="fr">ğŸ‡«ğŸ‡· FranÃ§ais</option>
                <option value="en">ğŸ‡ºğŸ‡¸ English</option>
                <option value="ar">ğŸ‡¹ğŸ‡³ Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</option>
                <option value="es">ğŸ‡ªğŸ‡¸ EspaÃ±ol</option>
                <option value="de">ğŸ‡©ğŸ‡ª Deutsch</option>
                <option value="it">ğŸ‡®ğŸ‡¹ Italiano</option>
                <option value="zh">ğŸ‡¨ğŸ‡³ ä¸­æ–‡</option>
                <option value="ja">ğŸ‡¯ğŸ‡µ æ—¥æœ¬èª</option>
            </select>
        </div>
        </header>
<header class="mobile-header">
  <a href="index.html" class="logo">
    <img src="images/logo8.png" alt="TechHaven Logo">
  </a>

  <div class="icons">
    <!-- SEARCH ICON -->
    <span class="mobile-icon" onclick="toggleMobileSearch()">
      <i class="fas fa-search"></i>
    </span>

    <!-- USER / LOGIN / LOGOUT -->
    <span id="mobile-user-control" class="mobile-icon">
      <i class="fas fa-user"></i>
    </span>

    <!-- CART ICON -->
    <a href="cart.html" class="mobile-icon cart-container">
      <i class="fas fa-shopping-cart"></i>
      <span class="badge" id="mobile-cart-count">0</span>
    </a>

  <div class="language-container">
  <select class="language-select">
    <option value="fr">ğŸ‡«ğŸ‡·</option>
    <option value="en">ğŸ‡¬ğŸ‡§</option>
    <option value="ar">TN</option>
    <option value="es">ğŸ‡ªğŸ‡¸</option>
    <option value="de">ğŸ‡©ğŸ‡ª</option>
    <option value="it">ğŸ‡®ğŸ‡¹</option>
    <option value="zh">ğŸ‡¨ğŸ‡³</option>
    <option value="ja">ğŸ‡¯ğŸ‡µ</option>
  </select>
  </div>
</div>

<div id="mobile-search-container" class="mobile-search hidden">
  <div class="mobile-search-wrapper">
    <i class="fas fa-search search-icon-inside"></i>
    <input type="text" id="mobileSearchInput" placeholder="Rechercher un produit..." />
    <i class="fas fa-times clear-icon" onclick="clearMobileSearch()"></i>
  </div>
  <div id="mobileSearchResultsDropdown" class="search-results-dropdown"></div>
</div>


</header>

 
    <section class="hero-slider">
        <div class="slides">
            <div class="slide active" style="background-image: url('https://images.unsplash.com/photo-1517336714731-489689fd1ca8');">
                <div class="slide-content">
                    <h1 data-i18n="hero1.title">Informatique dâ€™occasion, de vraies occasions.</h1>
                    <a href="promo.html" class="hero-button" data-i18n="hero1.button">Voir les offres</a>
                    <a href="#nos-categories" class="hero-button">DÃ©couvrir nos produits</a>
                </div>
            </div>
            <div class="slide" style="background-image: url('images/bg.png');">
                <div class="slide-content">
                    <h1 data-i18n="hero2.title">7 jours de test, 3 mois de garantie, satisfait ou remboursÃ©.</h1>
                    <a href="service.html" class="hero-button" data-i18n="hero2.button">Lire notre politique de service</a>
                    <a href="https://wa.me/41767576430" class="hero-button secondary" data-i18n="hero3.button2">Contactez-nous</a>
                </div>
            </div>
            <div class="slide" style="background-image: url('https://images.unsplash.com/photo-1518770660439-4636190af475');">
                <div class="slide-content">
                    <h1 data-i18n="hero3.title">ImportÃ© de Suisse, Ã  un prix imbattable.</h1>
                    <a href="#nos-categories" class="hero-button primary" data-i18n="hero3.button1">Nos catÃ©gories</a>
                </div>
            </div>
        </div>
 
        <button class="arrow left" onclick="prevSlide()">â®</button>
        <button class="arrow right" onclick="nextSlide()">â¯</button>
 
        <div class="dots">
            <span class="dot" onclick="goToSlide(0)"></span>
            <span class="dot" onclick="goToSlide(1)"></span>
            <span class="dot" onclick="goToSlide(2)"></span>
        </div>
    </section>
 
    <section id="nos-categories" class="categories-section">
        <h2 data-i18n="categories.title">Nos CatÃ©gories</h2>
        <div class="categories-container">
            <a href="pc.html" id="pcs" class="category-card pc">
                <h3 data-i18n="category.pcs">PCs</h3>
            </a>
            <a href="smartphones.html" id="smartphones" class="category-card smartphone">
                <h3 data-i18n="category.smartphones">Smartphones</h3>
            </a>
            <a href="smartthings.html" id="smartthings" class="category-card smart-things">
                <h3 data-i18n="category.smartthings">Smart Things</h3>
                <p data-i18n="category.smartthings_desc">(Montres, casques, enceintes, PS5, ...)</p>
            </a>
        </div>
    </section>
 
    <section id="customer-testimonials" class="customer-testimonials-section">
        <h2 data-i18n="testimonials.title">Ce que nos clients satisfaits disent !</h2>
        <p class="section-intro" data-i18n="testimonials.intro">Des conversations authentiques qui parlent d'elles-mÃªmes. DÃ©couvrez pourquoi nos clients adorent TechHaven.</p>
        <div class="testimonials-grid">
            <div class="testimonial-item">
                <img src="./images/w0.jpeg" alt="Capture d'Ã©cran - Client satisfait 1" data-full-src="./images/w0.jpeg">
            </div>
            <div class="testimonial-item">
                <img src="./images/w2.jpeg" alt="Capture d'Ã©cran - Client satisfait 2" data-full-src="./images/w2.jpeg">
            </div>
            <div class="testimonial-item">
                <img src="./images/w1.jpeg" alt="Capture d'Ã©cran - Client satisfait 3" data-full-src="./images/w1.jpeg">
            </div>
            <div class="testimonial-item">
                <img src="./images/w3.jpeg" alt="Capture d'Ã©cran - Client satisfait 4" data-full-src="./images/w3.jpeg">
            </div>
            <div class="testimonial-item">
                <img src="./images/w4.jpeg" alt="Capture d'Ã©cran - Client satisfait 5" data-full-src="./images/w4.jpeg">
            </div>
            <div class="testimonial-item">
                <img src="./images/w5.jpeg" alt="Capture d'Ã©cran - Client satisfait 6" data-full-src="./images/w5.jpeg">
            </div>
            <div class="testimonial-item">
                <img src="./images/w6.jpeg" alt="Capture d'Ã©cran - Client satisfait 7" data-full-src="./images/w6.jpeg">
            </div>
            <div class="testimonial-item">
                <img src="./images/w7.jpeg" alt="Capture d'Ã©cran - Client satisfait 8" data-full-src="./images/w7.jpeg">
            </div>
            <div class="testimonial-item">
                <img src="./images/w8.jpeg" alt="Capture d'Ã©cran - Client satisfait 9" data-full-src="./images/w8.jpeg">
            </div>
        </div>
       
        <a href="review.html" class="submit-review-button" data-i18n="testimonials.button">Partagez votre expÃ©rience !</a>
    </section>
 
    <footer class="main-footer">
        <div class="footer-content">
            <div class="footer-section about">
                <h3 data-i18n="footer.about_title">Ã€ Propos de TecHaven</h3>
                <p data-i18n="footer.about_text">Votre destination unique pour des PC, des composants et des accessoires informatiques de haute qualitÃ©. Nous nous engageons Ã  offrir les meilleures technologies et un service client exceptionnel.</p>
            </div>
            <div class="footer-section links">
                <h3 data-i18n="footer.links_title">Liens Utiles</h3>
                <ul>
                    <li><a href="index.html" data-i18n="nav.home">Accueil</a></li>
                    <li><a href="pc.html" data-i18n="nav.pc">PCs</a></li>
                    <li><a href="smartphones.html" data-i18n="nav.smartphones">Smartphones</a></li>
                    <li><a href="smartthings.html" data-i18n="nav.smartthings">Smart Things</a></li>
                    <li><a href="promo.html" data-i18n="nav.promo">page de promo</a></li>
                    <li><a href="cart.html" data-i18n="header.cart">Panier</a></li>
                </ul>
            </div>
            <div class="footer-section contact">
                <h3 data-i18n="footer.contact_title">Contactez-nous</h3>
                <p><i class="fas fa-map-marker-alt"></i> 123 Rue de la Tech, Tunis, Tunisie</p>
                <p><i class="fas fa-phone"></i> +41 76 757 64 30</p>
                <p><i class="fas fa-envelope"></i> techaven03@gmail.com</p>
                <div class="social-icons">
                    <a href="https://www.facebook.com/KB18031989"><img src="images/f.jpg" alt="Facebook" style="width: 24px; height: 24px;"></a>
                    <a href="https://wa.me/41767576430"><img src="images/w.png" alt="WhatsApp" style="width: 24px; height: 24px;"></a>
                </div>
            </div>
        </div>
        <div class="footer-bottom">
  <span data-i18n="footer.copyright">
    &copy; <span id="current-year"></span> TecHaven. Tous droits rÃ©servÃ©s.
  </span>
  <li><a href="service.html" class="footer-policy-link">Lire notre politique de service</a></li>
</div>

    </footer>
 
    <script src="js/cart.js"></script>
 
    <div id="lightbox" class="lightbox">
        <span class="lightbox-close">&times;</span>
        <img class="lightbox-content" id="lightbox-img">
        <div id="lightbox-caption" class="lightbox-caption"></div>
    </div>
 
    <script>
        // --- Configuration ---
const API_BASE_URL = 'https://techaven.onrender.com/api'; // Ensure this is consistent


// ... (your existing event listeners for keypress and click) ...
 

 
// Event Listener for click on search icon
        // --- SLIDER FUNCTIONALITY ---
        const slides = document.querySelectorAll('.slide');
        const dots = document.querySelectorAll('.dot');
        let currentSlide = 0;
        let slideInterval = setInterval(nextSlide, 5000);
 
        function showSlide(index) {
            slides.forEach((slide, i) => {
                slide.classList.remove('active');
                dots[i].classList.remove('active');
                if (i === index) {
                    slide.classList.add('active');
                    dots[i].classList.add('active');
                }
            });
            currentSlide = index;
        }
 
        function nextSlide() {
            showSlide((currentSlide + 1) % slides.length);
        }
 
        function prevSlide() {
            showSlide((currentSlide - 1 + slides.length) % slides.length);
        }
 
        function goToSlide(index) {
            showSlide(index);
        }
 
        showSlide(0); // Initialize slider
 
        // --- USER LOGIN/LOGOUT UI ---
        const currentUser = JSON.parse(localStorage.getItem("currentUser"));
        const userControls = document.getElementById("user-controls");
 
        function updateLoginUI(lang) {
            if (currentUser) {
                userControls.innerHTML = `
                    <div class="icon-button">
                        <span class="icon">ğŸ‘‹</span>
                        <span class="text" data-i18n="header.greeting">${lang === "es" ? "Hola" : lang === 'en' ? 'Hello' : lang === 'ar' ? 'Ù…Ø±Ø­Ø¨Ø§Ù‹' : 'Bonjour'}, ${currentUser.prenom}</span>
                    </div>
                    <button onclick="logout()" style="
                        margin-left: 10px;
                        background-color: #ff5e5e;
                        color: white;
                        border: none;
                        padding: 6px 12px;
                        border-radius: 6px;
                        cursor: pointer;
                    " data-i18n="header.logout_button"></button>
                `;
                // Manually set text for the dynamic logout button after creation
                const logoutButton = userControls.querySelector('button');
                if (logoutButton) {
                    logoutButton.textContent = translations[lang]['header.logout_button'] || translations['fr']['header.logout_button'];
                }
 
            } else {
                userControls.innerHTML = `
                    <a href="login.html" class="icon-button">
                        <span class="icon">ğŸ‘¤</span>
                        <span class="text" data-i18n="header.login"></span>
                    </a>
                `;
                // Manually set text for the login link after creation
                const loginLinkText = userControls.querySelector('[data-i18n="header.login"]');
                if (loginLinkText) {
                    loginLinkText.textContent = translations[lang]['header.login'] || translations['fr']['header.login'];
                }
            }
        }
 
 
        function logout() {
            localStorage.removeItem("currentUser");
            localStorage.removeItem("role");
            window.location.reload();
        }
        // --- CATEGORY IMAGE ROTATION ---
        const categoryImages = {
            pcs: [
              "https://images.unsplash.com/photo-1537498425277-c283d32ef9db?q=80&w=2078&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D",
              "https://images.unsplash.com/photo-1592919933511-ea9d487c85e4?w=600&auto=format&fit=crop&q=60&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxzZWFyY2h8MjB8fHBjfGVufDB8fDB8fHww"
            ],
            smartphones: [
                "https://images.unsplash.com/photo-1673718424704-51d0d2ca1fd2?w=600&auto=format&fit=crop&q=60&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxzZWFyY2h8NzZ8fHNtYXJ0cGhvbmVzfGVufDB8fDB8fHww",
                "https://images.unsplash.com/photo-1606594468925-47c7e77fa9f9?q=80&w=1974&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D"
            ],
            smartthings: [
                "https://images.unsplash.com/photo-1613497646519-ee1ab64293af?w=600&auto=format&fit=crop&q=60&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxzZWFyY2h8MTg1fHxTbWFydCUyMEhlYWRwaG9uZXN8ZW58MHwwfDB8fHww", // This URL appears broken, consider replacing.
                "https://images.unsplash.com/photo-1607853202273-797f1c22a38e?w=600&auto=format&fit=crop&q=60&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxzZWFyY2h8M3x8cHM1fGVufDB8fDB8fHww",
                "https://images.unsplash.com/photo-1557438159-51eec7a6c9e8?w=600&auto=format&fit=crop&q=60&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxzZWFyY2h8MTU0fHxTbWFydCUyMFdhdGNoZXN8ZW58MHwwfDB8fHww"
            ]
        };
 
        let currentIndex = {
            pcs: 0,
            smartphones: 0,
            smartthings: 0
        };
        window.addEventListener('DOMContentLoaded', () => {
    Object.keys(categoryImages).forEach(category => {
        const element = document.getElementById(category);
        if (element && categoryImages[category].length > 0) {
            const imageUrl = categoryImages[category][0];
            element.style.backgroundImage = `url('${imageUrl}')`;
            console.log(`Setting initial background for ${category}: ${imageUrl}`);
        } else if (!element) {
            console.warn(`Element with ID '${category}' not found.`);
        } else if (categoryImages[category].length === 0) {
            console.warn(`No images defined for category: ${category}`);
        }
    });
 
    // Rotation toutes les 3 secondes
    setInterval(() => rotateCategoryImage('pcs', 'pcs'), 3000);
    setInterval(() => rotateCategoryImage('smartphones', 'smartphones'), 3000);
    setInterval(() => rotateCategoryImage('smartthings', 'smartthings'), 3000);
});
 
        function rotateCategoryImage(category, elementId) {
            const images = categoryImages[category];
            if (!images || images.length === 0) return; // Add check for empty array
 
            currentIndex[category] = (currentIndex[category] + 1) % images.length;
            document.getElementById(elementId).style.backgroundImage =
                `url('${images[currentIndex[category]]}')`;
        }
 
        // --- LIGHTBOX FUNCTIONALITY ---
        const lightbox = document.getElementById('lightbox');
        const lightboxImg = document.getElementById('lightbox-img');
        const lightboxCaption = document.getElementById('lightbox-caption');
        const closeBtn = document.getElementsByClassName('lightbox-close')[0];
 
        // Get all testimonial images
        const testimonialImages = document.querySelectorAll('.testimonial-item img');
 
        testimonialImages.forEach(img => {
            img.addEventListener('click', function() {
                lightbox.style.display = 'block';
                lightboxImg.src = this.dataset.fullSrc || this.src;
                lightboxCaption.innerHTML = this.alt;
            });
        });
 
        closeBtn.addEventListener('click', function() {
            lightbox.style.display = 'none';
        });
 
        lightbox.addEventListener('click', function(event) {
            if (event.target === lightbox) {
                lightbox.style.display = 'none';
            }
        });
 
        // --- LANGUAGE TRANSLATION FUNCTIONALITY ---
        const languageSelect = document.querySelector('.language-select');
let currentLang = localStorage.getItem('lang') || 'fr'; // Default to French
        // 1. Define your translations
        const translations = {
            fr: {
                // Header/Navigation
                "header.search_placeholder": "Rechercher...",
                "header.login": "Connexion",
                "header.cart": "Mon Panier",
                "header.greeting": "Bonjour", // For dynamic greeting
                "header.logout_button": "DÃ©connexion",
 
                // Navigation Links
                "nav.home": "Accueil",
                "nav.pc": "PC",
                "nav.smartphones": "Smartphones",
                "nav.smartthings": "SmartThings",
                "nav.promo": "page de promo",
                "nav.contact": "Contact",
 
                // Hero Banner (Slide 1)
                "hero1.title": "Informatique dâ€™occasion, de vraies occasions.",
                "hero1.button": " Voir les offres",
 
                // Hero Banner (Slide 2)
                "hero2.title": "7 jours de test, 3 mois de garantie, satisfait ou remboursÃ©.",
                "hero2.button": "Lire notre politique de service",
 
                // Hero Banner (Slide 3)
                "hero3.title": " ImportÃ© de Suisse, Ã  un prix imbattable.",
                "hero3.button1": "Nos catÃ©gories",
 
                // Categories Section
                "categories.title": "Nos CatÃ©gories",
                "category.pcs": "PCs",
                "category.smartphones": "Smartphones",
                "category.smartthings": "Smart Things",
                "category.smartthings_desc": "(Montres, casques, enceintes, PS5, ...)",
 
                // Testimonials Section
                "testimonials.title": "Ce que nos clients satisfaits disent !",
                "testimonials.intro": "Des conversations authentiques qui parlent d'elles-mÃªmes. DÃ©couvrez pourquoi nos clients adorent TechHaven.",
                "testimonials.note": "*Pour des raisons de confidentialitÃ©, les noms et numÃ©ros ont Ã©tÃ© masquÃ©s sur les captures d'Ã©cran.",
                "testimonials.button": "Partagez votre expÃ©rience !",
                
                "no_results_message": "Aucun rÃ©sultat trouvÃ©.",
                "search_results.title": "RÃ©sultats de Recherche",
                "search_results.no_products": "Aucun produit trouvÃ© pour votre recherche.",
                "product_card.add_to_cart": "Ajouter au panier",
                "product_card.out_of_stock": "Rupture de Stock",

                // Footer
                "footer.about_title": "Ã€ Propos de TecHaven",
                "footer.about_text": "Votre destination unique pour des PC, des composants et des accessoires informatiques de haute qualitÃ©. Nous nous engageons Ã  offrir les meilleures technologies et un service client exceptionnel.",
                "footer.links_title": "Liens Utiles",
                "footer.my_account": "",
                "footer.copyright": "Â© <span id=\"current-year-placeholder\"></span> TecHaven. Tous droits rÃ©servÃ©s." // Placeholder for year
            },
            en: {
                // Header/Navigation
                "header.search_placeholder": "Search...",
                "header.login": "Log In",
                "header.cart": "My Cart",
                "header.greeting": "Hello",
                "header.logout_button": "Log Out",
 
                // Navigation Links
                "nav.home": "Home",
                "nav.pc": "PCs",
                "nav.smartphones": "Smartphones",
                "nav.smartthings": "Smart Things",
                "nav.promo": "Promo Page",
                "nav.contact": "Contact",
 
                // Hero Banner (Slide 1)
                "hero1.title": "Used tech, real deals.",
                "hero1.button": "View offers",

                "hero2.title": "7-day trial, 3-month warranty, satisfaction guaranteed.",
                "hero2.button": "Read our service policy",

                "hero3.title": "Imported from Switzerland, at an unbeatable price.",
                "hero3.button1": "Our categories",

 
                // Categories Section
                "categories.title": "Our Categories",
                "category.pcs": "PCs",
                "category.smartphones": "Smartphones",
                "category.smartthings": "Smart Things",
                "category.smartthings_desc": "(Watches, headsets, speakers, PS5, ...)",
 
                // Testimonials Section
                "testimonials.title": "What Our Happy Customers Say!",
                "testimonials.intro": "Authentic conversations that speak for themselves. Discover why our customers love TechHaven.",
                "testimonials.note": "*For privacy reasons, names and numbers have been blurred in screenshots.",
                "testimonials.button": "Share Your Experience!",
 
                "no_results_message": "No results found.",
                "search_results.title": "Search Results",
                "search_results.no_products": "No products found for your search.",
                "product_card.add_to_cart": "Add to Cart",
                "product_card.out_of_stock": "Out of Stock",

                // Footer
                "footer.about_title": "About TecHaven",
                "footer.about_text": "Your one-stop destination for high-quality PCs, components, and computer accessories. We are committed to providing the best technology and exceptional customer service.",
                "footer.links_title": "Useful Links",
                "footer.my_account": "My Account",
                "footer.copyright": "Â© <span id=\"current-year-placeholder\"></span> TecHaven. All Rights Reserved."
            },
            ar: {
                // Header/Navigation
                "header.search_placeholder": "Ø¨Ø­Ø«...",
                "header.login": "ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„",
                "header.cart": "Ø³Ù„ØªÙŠ",
                "header.greeting": "Ù…Ø±Ø­Ø¨Ø§Ù‹",
                "header.logout_button": "ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬",
 
                // Navigation Links
                "nav.home": "Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©",
                "nav.pc": "Ø£Ø¬Ù‡Ø²Ø© Ø§Ù„ÙƒÙ…Ø¨ÙŠÙˆØªØ±",
                "nav.smartphones": "Ø§Ù„Ù‡ÙˆØ§ØªÙ Ø§Ù„Ø°ÙƒÙŠØ©",
                "nav.smartthings": "Ø§Ù„Ø£Ø´ÙŠØ§Ø¡ Ø§Ù„Ø°ÙƒÙŠØ©",
                "nav.promo": "ØµÙØ­Ø© Ø§Ù„Ø¹Ø±ÙˆØ¶",
                "nav.contact": "Ø§ØªØµÙ„ Ø¨Ù†Ø§",
 
                "hero1.title": "Ù…Ø¹Ù„ÙˆÙ…Ø§ØªÙŠØ© Ù…Ø³ØªØ¹Ù…Ù„Ø©ØŒ Ø¨Ø£Ø³Ø¹Ø§Ø± Ø­Ù‚ÙŠÙ‚ÙŠØ©.",
                "hero1.button": "Ø¹Ø±Ø¶ Ø§Ù„Ø¹Ø±ÙˆØ¶",

                "hero2.title": "7 Ø£ÙŠØ§Ù… ØªØ¬Ø±Ø¨Ø©ØŒ 3 Ø£Ø´Ù‡Ø± Ø¶Ù…Ø§Ù†ØŒ Ø§Ø³ØªØ±Ø¬Ø§Ø¹ ÙƒØ§Ù…Ù„ Ø¥Ù† Ù„Ù… ØªÙƒÙ† Ø±Ø§Ø¶ÙŠÙ‹Ø§.",
                "hero2.button": "Ø§Ù‚Ø±Ø£ Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø®Ø¯Ù…Ø©",

                "hero3.title": "Ù…Ø³ØªÙˆØ±Ø¯Ø© Ù…Ù† Ø³ÙˆÙŠØ³Ø±Ø§ØŒ Ø¨Ø³Ø¹Ø± Ù„Ø§ ÙŠÙØ¶Ø§Ù‡Ù‰.",
                "hero3.button1": "ÙØ¦Ø§ØªÙ†Ø§",

 
                // Categories Section
                "categories.title": "ÙØ¦Ø§ØªÙ†Ø§",
                "category.pcs": "Ø£Ø¬Ù‡Ø²Ø© Ø§Ù„ÙƒÙ…Ø¨ÙŠÙˆØªØ±",
                "category.smartphones": "Ø§Ù„Ù‡ÙˆØ§ØªÙ Ø§Ù„Ø°ÙƒÙŠØ©",
                "category.smartthings": "Ø§Ù„Ø£Ø¬Ù‡Ø²Ø© Ø§Ù„Ø°ÙƒÙŠØ©",
                "category.smartthings_desc": "(Ø³Ø§Ø¹Ø§ØªØŒ Ø³Ù…Ø§Ø¹Ø§Øª Ø±Ø£Ø³ØŒ Ù…ÙƒØ¨Ø±Ø§Øª ØµÙˆØªØŒ Ø¨Ù„Ø§ÙŠØ³ØªÙŠØ´Ù† 5ØŒ ...)",
 
                // Testimonials Section
                "testimonials.title": "Ù…Ø§Ø°Ø§ ÙŠÙ‚ÙˆÙ„ Ø¹Ù…Ù„Ø§Ø¤Ù†Ø§ Ø§Ù„Ø±Ø§Ø¶ÙˆÙ†!",
                "testimonials.intro": "Ù…Ø­Ø§Ø¯Ø«Ø§Øª Ø­Ù‚ÙŠÙ‚ÙŠØ© ØªØªØ­Ø¯Ø« Ø¹Ù† Ù†ÙØ³Ù‡Ø§. Ø§ÙƒØªØ´Ù Ù„Ù…Ø§Ø°Ø§ ÙŠØ­Ø¨ Ø¹Ù…Ù„Ø§Ø¤Ù†Ø§ TecHaven.",
                "testimonials.note": "*Ù„Ø£Ø³Ø¨Ø§Ø¨ ØªØªØ¹Ù„Ù‚ Ø¨Ø§Ù„Ø®ØµÙˆØµÙŠØ©ØŒ ØªÙ… Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø£Ø³Ù…Ø§Ø¡ ÙˆØ§Ù„Ø£Ø±Ù‚Ø§Ù… ÙÙŠ Ù„Ù‚Ø·Ø§Øª Ø§Ù„Ø´Ø§Ø´Ø©.",
                "testimonials.button": "Ø´Ø§Ø±Ùƒ ØªØ¬Ø±Ø¨ØªÙƒ!",
 
                "no_results_message": "Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ù†ØªØ§Ø¦Ø¬.",
                "search_results.title": "Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø¨Ø­Ø«",
                "search_results.no_products": "Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ù…Ù†ØªØ¬Ø§Øª Ù„Ø¨Ø­Ø«Ùƒ.",
                "product_card.add_to_cart": "Ø£Ø¶Ù Ø¥Ù„Ù‰ Ø§Ù„Ø³Ù„Ø©",
                "product_card.out_of_stock": "Ù†ÙØ¯Øª Ø§Ù„ÙƒÙ…ÙŠØ©",

                // Footer
                "footer.about_title": "Ø­ÙˆÙ„ TecHaven",
                "footer.about_text": "ÙˆØ¬Ù‡ØªÙƒ Ø§Ù„ÙˆØ­ÙŠØ¯Ø© Ù„Ø£Ø¬Ù‡Ø²Ø© Ø§Ù„ÙƒÙ…Ø¨ÙŠÙˆØªØ± ÙˆØ§Ù„Ù…ÙƒÙˆÙ†Ø§Øª ÙˆÙ…Ù„Ø­Ù‚Ø§Øª Ø§Ù„ÙƒÙ…Ø¨ÙŠÙˆØªØ± Ø¹Ø§Ù„ÙŠØ© Ø§Ù„Ø¬ÙˆØ¯Ø©. Ù†Ø­Ù† Ù…Ù„ØªØ²Ù…ÙˆÙ† Ø¨ØªÙ‚Ø¯ÙŠÙ… Ø£ÙØ¶Ù„ Ø§Ù„ØªÙ‚Ù†ÙŠØ§Øª ÙˆØ®Ø¯Ù…Ø© Ø¹Ù…Ù„Ø§Ø¡ Ø§Ø³ØªØ«Ù†Ø§Ø¦ÙŠØ©.",
                "footer.links_title": "Ø±ÙˆØ§Ø¨Ø· Ù…ÙÙŠØ¯Ø©",
                "footer.my_account": "Ø­Ø³Ø§Ø¨ÙŠ",
                "footer.copyright": "Â© <span id=\"current-year-placeholder\"></span> TecHaven. Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø©."
            },
            // spanish
             es: { // ADD THIS NEW SPANISH TRANSLATION BLOCK
        // Header/Navigation
        "header.search_placeholder": "Buscar...",
        "header.login": "Iniciar SesiÃ³n",
        "header.cart": "Mi Carrito",
        "header.greeting": "Hola",
        "header.logout_button": "Cerrar SesiÃ³n",
 
        // Navigation Links
        "nav.home": "Inicio",
        "nav.pc": "PC",
        "nav.smartphones": "Smartphones",
        "nav.smartthings": "Smart Things",
        "nav.promo": "PÃ¡gina de promociones",
        "nav.contact": "Contacto",
 
        "hero1.title": "InformÃ¡tica de segunda mano, verdaderas oportunidades.",
        "hero1.button": "Ver ofertas",

        "hero2.title": "7 dÃ­as de prueba, 3 meses de garantÃ­a, satisfacciÃ³n o reembolso.",
        "hero2.button": "Leer nuestra polÃ­tica de servicio",

        "hero3.title": "Importado de Suiza, a un precio inmejorable.",
        "hero3.button1": "Nuestras categorÃ­as",

        // Categories Section
        "categories.title": "Nuestras CategorÃ­as",
        "category.pcs": "PCs",
        "category.smartphones": "Smartphones",
        "category.smartthings": "Smart Things",
        "category.smartthings_desc": "(Relojes, auriculares, altavoces, PS5, ...)",
 
        // Testimonials Section
        "testimonials.title": "Â¡Lo que dicen nuestros clientes satisfechos!",
        "testimonials.intro": "Conversaciones autÃ©nticas que hablan por sÃ­ solas. Descubre por quÃ© nuestros clientes adoran TechHaven.",
        "testimonials.note": "*Por razones de privacidad, los nombres y nÃºmeros han sido difuminados en las capturas de pantalla.",
        "testimonials.button": "Â¡Comparte tu experiencia!",
 
        // Footer
        "footer.about_title": "Acerca de TechHaven",
        "footer.about_text": "Tu destino Ãºnico para PCs, componentes y accesorios informÃ¡ticos de alta calidad. Nos comprometemos a ofrecer la mejor tecnologÃ­a y un servicio al cliente excepcional.",
        "footer.links_title": "Enlaces Ãštiles",
        "footer.my_account": "Mi Cuenta",
        "footer.copyright": "Â© <span id=\"current-year-placeholder\"></span> TechHaven. Todos los derechos reservados."
    },
     de: { // ADD THIS NEW GERMAN TRANSLATION BLOCK
        // Header/Navigation
        "header.search_placeholder": "Suchen...",
        "header.login": "Anmelden",
        "header.cart": "Mein Warenkorb",
        "header.greeting": "Hallo",
        "header.logout_button": "Abmelden",
 
        // Navigation Links
        "nav.home": "Startseite",
        "nav.pc": "PCs",
        "nav.smartphones": "Smartphones",
        "nav.smartthings": "Smart Things",
        "nav.promo": "Angebotsseite",
        "nav.contact": "Kontakt",
 
        "hero1.title": "Gebruikte IT, echte koopjes.",
        "hero1.button": "Bekijk aanbiedingen",

        "hero2.title": "7 dagen op proef, 3 maanden garantie, niet tevreden geld terug.",
        "hero2.button": "Lees ons servicebeleid",

        "hero3.title": "GeÃ¯mporteerd uit Zwitserland, voor een onverslaanbare prijs.",
        "hero3.button1": "Onze categorieÃ«n",

        "categories.title": "Unsere Kategorien",
        "category.pcs": "PCs",
        "category.smartphones": "Smartphones",
        "category.smartthings": "Smart Things",
        "category.smartthings_desc": "(Uhren, Headsets, Lautsprecher, PS5, ...)",
 
        // Testimonials Section
        "testimonials.title": "Was unsere zufriedenen Kunden sagen!",
        "testimonials.intro": "Authentische GesprÃ¤che, die fÃ¼r sich sprechen. Entdecken Sie, warum unsere Kunden TechHaven lieben.",
        "testimonials.note": "*Aus DatenschutzgrÃ¼nden wurden Namen und Nummern auf den Screenshots unkenntlich gemacht.",
        "testimonials.button": "Teilen Sie Ihre Erfahrung!",
 
        // Footer
        "footer.about_title": "Ãœber TechHaven",
        "footer.about_text": "Ihr One-Stop-Ziel fÃ¼r hochwertige PCs, Komponenten und ComputerzubehÃ¶r. Wir sind bestrebt, die beste Technologie und einen auÃŸergewÃ¶hnlichen Kundenservice zu bieten.",
        "footer.links_title": "NÃ¼tzliche Links",
        "footer.my_account": "Mein Konto",
        "footer.copyright": "Â© <span id=\"current-year-placeholder\"></span> TechHaven. Alle Rechte vorbehalten."
    },ja: { // ADD THIS NEW JAPANESE TRANSLATION BLOCK
        // Header/Navigation
        "header.search_placeholder": "æ¤œç´¢...",
        "header.login": "ãƒ­ã‚°ã‚¤ãƒ³",
        "header.cart": "ãƒã‚¤ã‚«ãƒ¼ãƒˆ",
        "header.greeting": "ã“ã‚“ã«ã¡ã¯",
        "header.logout_button": "ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ",
 
        // Navigation Links
        "nav.home": "ãƒ›ãƒ¼ãƒ ",
        "nav.pc": "PC",
        "nav.smartphones": "ã‚¹ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒ³",
        "nav.smartthings": "ã‚¹ãƒãƒ¼ãƒˆãƒ‡ãƒã‚¤ã‚¹",
        "nav.promo": "ãƒ—ãƒ­ãƒ¢ãƒ¼ã‚·ãƒ§ãƒ³ãƒšãƒ¼ã‚¸",
        "nav.contact": "ãŠå•ã„åˆã‚ã›",
 
        "hero1.title": "ä¸­å¤ãƒ‘ã‚½ã‚³ãƒ³ã€æœ¬å½“ã®ãŠå¾—ã€‚",
        "hero1.button": "ã‚ªãƒ•ã‚¡ãƒ¼ã‚’è¦‹ã‚‹",

        "hero2.title": "7æ—¥é–“ã®è©¦ç”¨ã€3ãƒ¶æœˆä¿è¨¼ã€æº€è¶³ã§ããªã‘ã‚Œã°è¿”é‡‘ã€‚",
        "hero2.button": "ã‚µãƒ¼ãƒ“ã‚¹ãƒãƒªã‚·ãƒ¼ã‚’èª­ã‚€",

        "hero3.title": "ã‚¹ã‚¤ã‚¹ã‹ã‚‰è¼¸å…¥ã€ä»–ã«ãªã„ä¾¡æ ¼ã€‚",
        "hero3.button1": "ã‚«ãƒ†ã‚´ãƒªã‚’è¦‹ã‚‹",

        
        // Categories Section
        "categories.title": "ã‚«ãƒ†ã‚´ãƒªãƒ¼",
        "category.pcs": "PC",
        "category.smartphones": "ã‚¹ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒ³",
        "category.smartthings": "ã‚¹ãƒãƒ¼ãƒˆãƒ‡ãƒã‚¤ã‚¹",
        "category.smartthings_desc": "(æ™‚è¨ˆã€ãƒ˜ãƒƒãƒ‰ã‚»ãƒƒãƒˆã€ã‚¹ãƒ”ãƒ¼ã‚«ãƒ¼ã€PS5ãªã©)",
 
        // Testimonials Section
        "testimonials.title": "ãŠå®¢æ§˜ã®å£°",
        "testimonials.intro": "ä¿¡é ¼ã§ãã‚‹ãŠå®¢æ§˜ã®å£°ã€‚ãªãœãŠå®¢æ§˜ãŒTechHavenã‚’æ„›ã—ã¦ã„ã‚‹ã®ã‹ã‚’ã”è¦§ãã ã•ã„ã€‚",
        "testimonials.note": "â€»ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ä¿è­·ã®ãŸã‚ã€ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆã®æ°åã¨ç•ªå·ã¯éš ã•ã‚Œã¦ã„ã¾ã™ã€‚",
        "testimonials.button": "ã‚ãªãŸã®ä½“é¨“ã‚’å…±æœ‰ã™ã‚‹ï¼",
 
        // Footer
        "footer.about_title": "TechHavenã«ã¤ã„ã¦",
        "footer.about_text": "é«˜å“è³ªãªPCã€ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã€ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼ã‚¢ã‚¯ã‚»ã‚µãƒªãƒ¼ã®ãƒ¯ãƒ³ã‚¹ãƒˆãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒ—ã§ã™ã€‚æœ€é«˜ã®ãƒ†ã‚¯ãƒãƒ­ã‚¸ãƒ¼ã¨å„ªã‚ŒãŸé¡§å®¢ã‚µãƒ¼ãƒ“ã‚¹ã‚’æä¾›ã™ã‚‹ã“ã¨ã‚’ãŠç´„æŸã—ã¾ã™ã€‚",
        "footer.links_title": "ä¾¿åˆ©ãªãƒªãƒ³ã‚¯",
        "footer.my_account": "ãƒã‚¤ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ",
        "footer.copyright": "Â© <span id=\"current-year-placeholder\"></span> TechHaven. ç„¡æ–­è¤‡å†™ãƒ»è»¢è¼‰ã‚’ç¦ã˜ã¾ã™ã€‚"
    },
it: { // ADD THIS NEW ITALIAN TRANSLATION BLOCK
        // Header/Navigation
        "header.search_placeholder": "Cerca...",
        "header.login": "Accedi",
        "header.cart": "Il mio carrello",
        "header.greeting": "Ciao",
        "header.logout_button": "Esci",
 
        // Navigation Links
        "nav.home": "Home",
        "nav.pc": "PC",
        "nav.smartphones": "Smartphone",
        "nav.smartthings": "Smart Things",
        "nav.promo": "Pagina promozioni",
        "nav.contact": "Contatti",
 
        "hero1.title": "Informatica usata, vere occasioni.",
        "hero1.button": "Vedi le offerte",

        "hero2.title": "7 giorni di prova, 3 mesi di garanzia, soddisfatti o rimborsati.",
        "hero2.button": "Leggi la nostra politica di servizio",

        "hero3.title": "Importato dalla Svizzera, a un prezzo imbattibile.",
        "hero3.button1": "Le nostre categorie",

 
        // Categories Section
        "categories.title": "Le Nostre Categorie",
        "category.pcs": "PC",
        "category.smartphones": "Smartphone",
        "category.smartthings": "Smart Things",
        "category.smartthings_desc": "(Orologi, cuffie, altoparlanti, PS5, ...)",
 
        // Testimonials Section
        "testimonials.title": "Cosa dicono i nostri clienti soddisfatti!",
        "testimonials.intro": "Conversazioni autentiche che parlano da sole. Scopri perchÃ© i nostri clienti amano TechHaven.",
        "testimonials.note": "*Per motivi di privacy, nomi e numeri sono stati oscurati negli screenshot.",
        "testimonials.button": "Condividi la tua esperienza!",
 
        // Footer
        "footer.about_title": "Informazioni su TechHaven",
        "footer.about_text": "La tua destinazione unica per PC, componenti e accessori informatici di alta qualitÃ . Ci impegniamo a offrire la migliore tecnologia e un servizio clienti eccezionale.",
        "footer.links_title": "Link utili",
        "footer.my_account": "Il mio account",
        "footer.copyright": "Â© <span id=\"current-year-placeholder\"></span> TechHaven. Tutti i diritti riservati."
    },
    zh: { // ADD THIS NEW CHINESE TRANSLATION BLOCK (Simplified Chinese)
        // Header/Navigation
        "header.search_placeholder": "æœç´¢...",
        "header.login": "ç™»å½•",
        "header.cart": "æˆ‘çš„è´­ç‰©è½¦",
        "header.greeting": "ä½ å¥½",
        "header.logout_button": "é€€å‡º",
 
        // Navigation Links
        "nav.home": "é¦–é¡µ",
        "nav.pc": "ç”µè„‘",
        "nav.smartphones": "æ™ºèƒ½æ‰‹æœº",
        "nav.smartthings": "æ™ºèƒ½è®¾å¤‡",
        "nav.promo": "ä¿ƒé”€é¡µé¢",
        "nav.contact": "è”ç³»æˆ‘ä»¬",
 
        "hero1.title": "äºŒæ‰‹ç”µè„‘ï¼ŒçœŸæ­£å®æƒ ã€‚",
        "hero1.button": "æŸ¥çœ‹ä¼˜æƒ ",

        "hero2.title": "7å¤©è¯•ç”¨ï¼Œ3ä¸ªæœˆä¿ä¿®ï¼Œä¸æ»¡æ„å¯é€€æ¬¾ã€‚",
        "hero2.button": "é˜…è¯»æˆ‘ä»¬çš„æœåŠ¡æ”¿ç­–",

        "hero3.title": "ç‘å£«è¿›å£ï¼Œä»·æ ¼æ— ä¸ä¼¦æ¯”ã€‚",
        "hero3.button1": "æˆ‘ä»¬çš„åˆ†ç±»",

 
        // Categories Section
        "categories.title": "æˆ‘ä»¬çš„åˆ†ç±»",
        "category.pcs": "ç”µè„‘",
        "category.smartphones": "æ™ºèƒ½æ‰‹æœº",
        "category.smartthings": "æ™ºèƒ½è®¾å¤‡",
        "category.smartthings_desc": "(æ‰‹è¡¨ã€è€³æœºã€éŸ³ç®±ã€PS5ç­‰)",
 
        // Testimonials Section
        "testimonials.title": "å®¢æˆ·è¯„ä»·",
        "testimonials.intro": "çœŸå®çš„å¯¹è¯ï¼Œä¸è¨€è€Œå–»ã€‚äº†è§£ä¸ºä»€ä¹ˆæˆ‘ä»¬çš„å®¢æˆ·å–œçˆ± TechHavenã€‚",
        "testimonials.note": "*å‡ºäºéšç§åŸå› ï¼Œå±å¹•æˆªå›¾ä¸­çš„å§“åå’Œå·ç å·²æ¨¡ç³Šå¤„ç†ã€‚",
        "testimonials.button": "åˆ†äº«æ‚¨çš„ä½“éªŒï¼",
 
        // Footer
        "footer.about_title": "å…³äº TechHaven",
        "footer.about_text": "æ‚¨è´­ä¹°é«˜å“è´¨ç”µè„‘ã€ç»„ä»¶å’Œç”µè„‘é…ä»¶çš„ä¸€ç«™å¼ç›®çš„åœ°ã€‚æˆ‘ä»¬è‡´åŠ›äºæä¾›æœ€å¥½çš„æŠ€æœ¯å’Œå“è¶Šçš„å®¢æˆ·æœåŠ¡ã€‚",
        "footer.links_title": "æœ‰ç”¨é“¾æ¥",
        "footer.my_account": "æˆ‘çš„è´¦æˆ·",
        "footer.copyright": "Â© <span id=\"current-year-placeholder\"></span> TechHaven. ä¿ç•™æ‰€æœ‰æƒåˆ©ã€‚"
    },
    // ... (rest of your existing translations and script) ...
};
    // ... (rest of your existing translations and script) ...
 
        // 2. Function to set the language
        function setLanguage(lang) {
            const elements = document.querySelectorAll('[data-i18n]');
            elements.forEach(element => {
                const key = element.getAttribute('data-i18n');
                if (translations[lang] && translations[lang][key]) {
                    element.textContent = translations[lang][key];
                    // Special handling for the footer copyright to preserve the span
                    if (key === "footer.copyright") {
                        const currentYear = new Date().getFullYear();
                        element.innerHTML = translations[lang][key].replace('<span id="current-year-placeholder"></span>', currentYear);
                    }
                } else {
                    // Fallback to default language (fr) if translation not found
                    element.textContent = translations['fr'][key] || element.textContent;
                     if (key === "footer.copyright") {
                        const currentYear = new Date().getFullYear();
                        element.innerHTML = (translations['fr'][key] || element.textContent).replace('<span id="current-year-placeholder\"></span>', currentYear);
                    }
                }
            });
 
            // Handle placeholders
            const placeholderElements = document.querySelectorAll('[data-i18n-placeholder]');
            placeholderElements.forEach(element => {
                const key = element.getAttribute('data-i18n-placeholder');
                if (translations[lang] && translations[lang][key]) {
                    element.placeholder = translations[lang][key];
                } else {
                    element.placeholder = translations['fr'][key] || element.placeholder;
                }
            });
 
 
            // Update login UI based on current language
            updateLoginUI(lang);
 
 
            // Save selected language to localStorage to remember user's choice
            localStorage.setItem('selectedLanguage', lang);
 
            // Update the select dropdown to show the active language
           const langSelects = document.querySelectorAll('.language-select');
const savedLang = localStorage.getItem('selectedLanguage') || 'fr';

langSelects.forEach(select => {
  select.value = savedLang;
  select.addEventListener('change', (event) => {
    setLanguage(event.target.value);
  });
});

             // Set dir attribute for RTL languages
            document.documentElement.dir = (lang === 'ar') ? 'rtl' : 'ltr';
            document.querySelectorAll('.language-select').forEach(select => {
    select.value = lang;
  });
        }
 
        // 3. Event Listener for language selector and initial load
       
        // --- Global Search Bar Logic (Common to multiple pages) ---
const searchInput = document.getElementById('searchInput');
const searchIcon = document.querySelector('.search-wrapper .search-icon');
let searchResultsDropdown = document.getElementById('searchResultsDropdown'); // Already created in HTML

let allProductsForSearch = []; // This will store all products for global search suggestions
let searchTimeout;

// Fetch ALL products once for the client-side search suggestions
async function fetchAllProductsForSearch() {
    try {
        const response = await fetch(`${API_BASE_URL}/products`);
        if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
        }
        allProductsForSearch = await response.json();
    } catch (error) {
        console.error("Could not fetch all products for global search bar suggestions:", error);
    }
}

function displaySuggestions(query) {
    searchResultsDropdown.innerHTML = ''; // Clear previous suggestions
    searchResultsDropdown.style.display = 'none';

    if (query.length < 2) { // Require at least 2 characters for suggestions
        return;
    }

    const lowerCaseQuery = query.toLowerCase();
    const filteredSuggestions = allProductsForSearch.filter(product =>
        product.name.toLowerCase().includes(lowerCaseQuery) ||
        (product.description && product.description.toLowerCase().includes(lowerCaseQuery)) ||
        (product.category && product.category.toLowerCase().includes(lowerCaseQuery)) ||
        (product.characteristics && product.characteristics.some(char => char.toLowerCase().includes(lowerCaseQuery)))
    );

    if (filteredSuggestions.length > 0) {
        filteredSuggestions.slice(0, 5).forEach(product => { // Show top 5 suggestions
            const suggestionItem = document.createElement('div');
            suggestionItem.classList.add('search-result-item');
            suggestionItem.dataset.productId = product._id; // Use _id for product detail page link

            const imageUrl = product.images && product.images.length > 0
                ? `${API_BASE_URL.replace('/api', '')}${product.images[0]}` // Correct URL for image
                : 'https://via.placeholder.com/50x50?text=No+Image';

            suggestionItem.innerHTML = `
                <img src="${imageUrl}" alt="${product.name}">
                <div class="search-result-item-info">
                    <h4>${product.name}</h4>
                    <p>${product.description ? product.description.substring(0, 50) + (product.description.length > 50 ? '...' : '') : ''}</p>
                </div>
                <span class="price-display">${
                    product.promotion_price !== undefined && product.promotion_price !== null && typeof product.promotion_price === 'number' && product.promotion_price < product.price
                        ? product.promotion_price.toFixed(2) + 'TND'
                        : product.price.toFixed(2) + 'TND'
                }</span>
            `;
            searchResultsDropdown.appendChild(suggestionItem);
        });
        searchResultsDropdown.style.display = 'block'; // Show dropdown
    } else {
        const noResultsDiv = document.createElement('div');
        noResultsDiv.classList.add('no-search-results');
        noResultsDiv.textContent = translations[currentLang]['no_results_message'];
        searchResultsDropdown.appendChild(noResultsDiv);
        searchResultsDropdown.style.display = 'block';
    }
}

// Handle input for live suggestions
if (searchInput) {
    searchInput.addEventListener('input', function() {
        clearTimeout(searchTimeout);
        searchTimeout = setTimeout(() => {
            const query = searchInput.value.trim();
            displaySuggestions(query);
        }, 300); // Debounce for 300ms
    });


    // Handle click on suggestion item (redirect to product detail page)
    searchResultsDropdown.addEventListener('click', function(event) {
        const clickedItem = event.target.closest('.search-result-item');
        if (clickedItem && clickedItem.dataset.productId) {
            const productId = clickedItem.dataset.productId;
            window.location.href = `product-detail.html?id=${productId}`;
            searchResultsDropdown.style.display = 'none'; // Hide dropdown
        }
    });

    // Hide dropdown on outside click
    document.addEventListener('click', function(event) {
        if (!searchInput.contains(event.target) && !searchResultsDropdown.contains(event.target) && (!searchIcon || !searchIcon.contains(event.target))) {
            searchResultsDropdown.style.display = 'none';
        }
    });
}
function toggleMobileSearch() {
  const container = document.getElementById("mobile-search-container");
  if (container) {
    container.classList.toggle("show");
  }
}

  document.addEventListener('DOMContentLoaded', () => {
            const langSelect = document.querySelector('.language-select');
            fetchAllProductsForSearch();
            if (langSelect) {
                // Get preferred language from localStorage or default to 'fr'
                const savedLang = localStorage.getItem('selectedLanguage') || 'fr';
                setLanguage(savedLang); // Set initial language on page load
 
                langSelect.addEventListener('change', (event) => {
                    setLanguage(event.target.value);
                });
            }
            if (document.body.dataset.category) { // Check if data-category attribute is present
        // Ensure fetchAndDisplayProducts is defined elsewhere in your script for category pages
        // Or integrate it directly here if it's not a global function
        fetchAndDisplayProducts(); // Call your function to display products for this category
    }

    // Example for product-detail.html:
    if (document.getElementById('product-details')) { // Check if product-details container exists
        // Ensure fetchAndDisplayProductDetails is defined elsewhere in your script for product-detail.html
        fetchAndDisplayProductDetails(); // Call your function to display product details
    }
    const mobileUserControl = document.getElementById("mobile-user-control");
const currentUser = JSON.parse(localStorage.getItem("currentUser"));

if (mobileUserControl) {
  if (currentUser) {
    mobileUserControl.innerHTML = `
      <i class="fas fa-user-check"></i>
      <span style="font-size: 10px; display: block;">${currentUser.prenom}</span>
    `;
  } else {
    mobileUserControl.innerHTML = `
      <i class="fas fa-user"></i>
      <span style="font-size: 10px; display: block;">Connecter</span>
    `;
  }

  mobileUserControl.addEventListener("click", () => {
    if (currentUser) {
      const confirmLogout = confirm(`Se dÃ©connecter de ${currentUser.prenom} ?`);
      if (confirmLogout) logout();
    } else {
      window.location.href = "login.html";
    }
  });
}


 

        });
        document.addEventListener('DOMContentLoaded', () => {
  const mobileInput = document.getElementById("mobileSearchInput");
  const mobileDropdown = document.getElementById("mobileSearchResultsDropdown");

  if (mobileInput) {
    mobileInput.addEventListener("input", () => {
      clearTimeout(searchTimeout);
      searchTimeout = setTimeout(() => {
        const query = mobileInput.value.trim();
        displayMobileSuggestions(query);
      }, 300);
    });

    mobileDropdown.addEventListener("click", (event) => {
      const clickedItem = event.target.closest(".search-result-item");
      if (clickedItem && clickedItem.dataset.productId) {
        window.location.href = `product-detail.html?id=${clickedItem.dataset.productId}`;
        mobileDropdown.style.display = "none";
      }
    });

    document.addEventListener("click", function (event) {
      if (!mobileInput.contains(event.target) && !mobileDropdown.contains(event.target)) {
        mobileDropdown.style.display = 'none';
      }
    });
  }
});
function displayMobileSuggestions(query) {
  const dropdown = document.getElementById('mobileSearchResultsDropdown');
  dropdown.innerHTML = '';
  dropdown.style.display = 'none';

  if (query.length < 2) return;

  const results = allProductsForSearch.filter(product =>
    product.name.toLowerCase().includes(query.toLowerCase())
  );

  if (results.length > 0) {
    results.slice(0, 5).forEach(product => {
      const div = document.createElement('div');
      div.classList.add('search-result-item');
      div.dataset.productId = product._id;
      div.innerHTML = `
        <img src="${product.images?.[0] ? `${API_BASE_URL.replace('/api', '')}${product.images[0]}` : 'https://via.placeholder.com/50x50?text=No+Image'}" alt="${product.name}">
        <div class="search-result-item-info">
          <h4>${product.name}</h4>
          <p>${product.description?.substring(0, 50) || ''}</p>
        </div>
        <span class="price-display">${product.promotion_price ?? product.price} TND</span>
      `;
      dropdown.appendChild(div);
    });
    dropdown.style.display = 'block';
  } else {
    const noResult = document.createElement('div');
    noResult.className = 'no-search-results';
    noResult.textContent = translations[currentLang]['no_results_message'];
    dropdown.appendChild(noResult);
    dropdown.style.display = 'block';
  }
}

        async function loadProducts() {
  const res = await fetch(`/api/products?_=${Date.now()}`); // cache-busting
  const products = await res.json();
  renderProducts(products);
}

    </script>
</body>
</html>