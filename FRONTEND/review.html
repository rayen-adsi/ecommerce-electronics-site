<!DOCTYPE html>
<html lang="fr">

<head>
  <meta charset="UTF-8">
  <title data-i18n="review_page.title">TechHaven - Soumettre un Avis</title>

  <!-- Favicon (make sure the file is in your project directory) -->
 <link rel="icon" href="images/logo2-removebg-preview (2).png" type="image/png">

  <!-- Responsive viewport -->
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Custom CSS -->
  <link rel="stylesheet" href="css/styles.css">

  <!-- Google Font -->
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@600&display=swap" rel="stylesheet">

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">

  <!-- Flag Icons -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/lipis/flag-icons@7.3.2/css/flag-icons.min.css" />

  <!-- Inline Styles -->
  <style>
    .review-form-container {
      max-width: 800px;
      margin: 80px auto 40px auto;
      padding: 30px;
      background-color: #f9f9f9;
      border-radius: 10px;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
      color: #333;
    }

    .review-form-container h1 {
      text-align: center;
      color: #2c3e50;
      margin-bottom: 30px;
      font-size: 2.2em;
    }

    .review-form-group {
      margin-bottom: 20px;
    }

    .review-form-group label {
      display: block;
      margin-bottom: 8px;
      font-weight: bold;
      color: #555;
    }

    .review-form-group input[type="text"],
    .review-form-group textarea {
      width: calc(100% - 20px);
      padding: 12px 10px;
      border: 1px solid #ddd;
      border-radius: 6px;
      font-size: 1em;
      box-sizing: border-box;
    }

    .review-form-group textarea {
      min-height: 120px;
      resize: vertical;
    }

    .rating {
      display: flex;
      flex-direction: row-reverse;
      justify-content: center;
      margin-top: 15px;
      margin-bottom: 25px;
    }

    .rating input {
      display: none;
    }

    .rating label {
      font-size: 2.5em;
      color: #ccc;
      cursor: pointer;
      padding: 0 5px;
      transition: color 0.2s;
    }

    .rating label:hover,
    .rating label:hover ~ label,
    .rating input:checked ~ label {
      color: #ffc107;
    }

    .file-upload-preview {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-top: 10px;
      border: 1px solid #eee;
      padding: 10px;
      border-radius: 8px;
      background-color: #fff;
      min-height: 50px;
    }

    .file-upload-preview img {
      max-width: 100px;
      max-height: 100px;
      border-radius: 5px;
      object-fit: cover;
      border: 1px solid #ddd;
    }

    .submit-review-btn {
      display: block;
      width: 100%;
      padding: 15px;
      background-color: #007bff;
      color: white;
      border: none;
      border-radius: 8px;
      font-size: 1.2em;
      cursor: pointer;
      transition: background-color 0.3s ease;
      margin-top: 20px;
    }

    .submit-review-btn:hover {
      background-color: #0056b3;
    }

    .success-message {
      text-align: center;
      margin-top: 30px;
      padding: 20px;
      background-color: #d4edda;
      color: #155724;
      border: 1px solid #c3e6cb;
      border-radius: 8px;
      font-size: 1.1em;
      display: none;
    }
    .review-media-thumbnail {
  width: 400px;
  height: 400px;
  object-fit: cover;
  border-radius: 8px;
  margin: 5px;
  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
}

  </style>
<body>
    <header class="main-header">
        <a href="index.html" class="logo">
            <img src="images/logo.png" alt="TechHaven Logo">
        </a>

        <div id="user-controls">
            <a href="login.html" class="icon-button">
                <span class="icon">ğŸ‘¤</span>
                <span class="text" data-i18n="header.login">Connexion</span>
            </a>
        </div>

        <a href="cart.html" class="icon-button cart-button">
            <span class="icon">ğŸ›’</span>
            <span class="badge">0</span>
            <span class="text" data-i18n="header.cart">Mon Panier</span>
        </a>

        <div class="icon-button language-button">
            <span class="icon">ğŸŒ</span>
            <select class="language-select">
                <option value="fr">ğŸ‡«ğŸ‡· FranÃ§ais</option>
                <option value="en">ğŸ‡ºğŸ‡¸ English</option>
                <option value="ar">ğŸ‡¹ğŸ‡³ Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</option>
                <option value="es">ğŸ‡ªğŸ‡¸ EspaÃ±ol</option>
                <option value="de">ğŸ‡©ğŸ‡ª Deutsch</option>
                <option value="it">ğŸ‡®ğŸ‡¹ Italiano</option>
                <option value="zh">ğŸ‡¨ğŸ‡³ ä¸­æ–‡</option>
                <option value="ja">ğŸ‡¯ğŸ‡µ æ—¥æœ¬èª</option>
            </select>
        </div>
    </header>

    <main class="review-form-container">
        <h1 data-i18n="review_page.heading">Soumettez votre avis</h1>
        <p data-i18n="review_page.intro">Nous serions ravis d'entendre parler de votre expÃ©rience avec TechHaven. Vos commentaires nous aident Ã  nous amÃ©liorer !</p>

        <form id="reviewForm">
            <div class="review-form-group">
                <label for="reviewerName" data-i18n="review_form.name_label">Votre Nom (optionnel):</label>
                <input type="text" id="reviewerName" name="reviewerName" data-i18n-placeholder="review_form.name_placeholder">
            </div>

            <div class="review-form-group">
                <label for="reviewText" data-i18n="review_form.review_label">Votre Avis (obligatoire):</label>
                <textarea id="reviewText" name="reviewText" required data-i18n-placeholder="review_form.review_placeholder"></textarea>
            </div>

            <div class="review-form-group">
                <label data-i18n="review_form.rating_label">Votre Note:</label>
                <div class="rating">
                    <input type="radio" id="star5" name="rating" value="5" /><label for="star5" title="5 Ã©toiles">â˜…</label>
                    <input type="radio" id="star4" name="rating" value="4" /><label for="star4" title="4 Ã©toiles">â˜…</label>
                    <input type="radio" id="star3" name="rating" value="3" /><label for="star3" title="3 Ã©toiles">â˜…</label>
                    <input type="radio" id="star2" name="rating" value="2" /><label for="star2" title="2 Ã©toiles">â˜…</label>
                    <input type="radio" id="star1" name="rating" value="1" /><label for="star1" title="1 Ã©toile">â˜…</label>
                </div>
            </div>

            <div class="review-form-group">
                <label for="reviewPhotos" data-i18n="review_form.photos_label">Ajouter des Photos (optionnel):</label>
                <input type="file" id="reviewPhotos" name="reviewPhotos" accept="image/*" multiple>
                <div class="file-upload-preview" id="fileUploadPreview">
                </div>
            </div>

            <button type="submit" class="submit-review-btn" data-i18n="review_form.submit_button">Soumettre l'avis</button>
        </form>

        <div id="successMessage" class="success-message" data-i18n="review_form.success_message">
            Merci pour votre avis ! Votre contribution est trÃ¨s apprÃ©ciÃ©e. (Ceci est une dÃ©mo. L'avis n'est pas rÃ©ellement sauvegardÃ©.)
        </div>

        <section class="submitted-reviews-section">
            <h2 data-i18n="review_page.recent_reviews_heading">Avis RÃ©cents</h2>
            <div class="reviews-list-container" id="reviewsListContainer">
                <p data-i18n="review_page.loading_reviews">Chargement des avis...</p>
            </div>
        </section>

    </main>

    <footer class="main-footer">
        <div class="footer-content">
            <div class="footer-section about">
                <h3 data-i18n="footer.about_title">Ã€ Propos de TecHaven</h3>
                <p data-i18n="footer.about_text">Votre destination unique pour des PC, des composants et des accessoires informatiques de haute qualitÃ©. Nous nous engageons Ã  offrir les meilleures technologies et un service client exceptionnel.</p>
            </div>
            <div class="footer-section links">
                <h3 data-i18n="footer.links_title">Liens Utiles</h3>
                <ul>
                    <li><a href="index.html" data-i18n="nav.home">Accueil</a></li>
                    <li><a href="pc.html" data-i18n="nav.pc">PCs</a></li>
                    <li><a href="smartphones.html" data-i18n="nav.smartphones">Smartphones</a></li>
                    <li><a href="smartthings.html" data-i18n="nav.smartthings">Smart Things</a></li>
                    <li><a href="promo.html" data-i18n="nav.promo">page de promo</a></li>
                    <li><a href="cart.html" data-i18n="header.cart">Panier</a></li>
                </ul>
            </div>
            <div class="footer-section contact">
                <h3 data-i18n="footer.contact_title">Contactez-nous</h3>
                <p><i class="fas fa-map-marker-alt"></i> 123 Rue de la Tech, Tunis, Tunisie</p>
                <p><i class="fas fa-phone"></i> +41 76 757 64 30</p>
                <p><i class="fas fa-envelope"></i> techaven03@gmail.com</p>
                <div class="social-icons">
                    <a href="https://www.facebook.com/KB18031989"><img src="images/f.jpg" alt="Facebook" style="width: 24px; height: 24px;"></a>
                    <a href="https://wa.me/41767576430"><img src="images/w.png" alt="WhatsApp" style="width: 24px; height: 24px;"></a>
                </div>
            </div>
        </div>
        <div class="footer-bottom">
           </span> TecHaven. Tous droits rÃ©servÃ©s.</span>
        </div>
    </footer>

    <script src="js/cart.js"></script>
    <script>
    // --- Internationalization (i18n) Translations ---
    // This object is CRUCIAL for your data-i18n attributes to work.
    // Ensure this is defined. If you have it in a separate file, load that file BEFORE this script.
    const translations = {
        fr: {
            "header.greeting": "Bonjour",
            "header.logout_button": "DÃ©connexion",
            "header.login": "Connexion",
            "header.search_placeholder": "Rechercher...",
            "header.cart": "Mon Panier",
            "review_page.title": "TechHaven - Soumettre un Avis",
            "review_page.heading": "Soumettez votre avis",
            "review_page.intro": "Nous serions ravis d'entendre parler de votre expÃ©rience avec TechHaven. Vos commentaires nous aident Ã  nous amÃ©liorer !",
            "review_form.name_label": "Votre Nom (optionnel):",
            "review_form.name_placeholder": "Entrez votre nom",
            "review_form.review_label": "Votre Avis (obligatoire):",
            "review_form.review_placeholder": "Partagez votre expÃ©rience...",
            "review_form.rating_label": "Votre Note:",
            "review_form.photos_label": "Ajouter des Photos (optionnel):",
            "review_form.submit_button": "Soumettre l'avis",
            "review_form.success_message": "Merci pour votre avis ! Votre contribution est trÃ¨s apprÃ©ciÃ©e. (Ceci est une dÃ©mo. L'avis n'est pas rÃ©ellement sauvegardÃ©.)",
            "review_page.recent_reviews_heading": "Avis RÃ©cents",
            "review_page.loading_reviews": "Chargement des avis...",
            "review_page.no_reviews": "Aucun avis pour le moment.",
            "footer.about_title": "Ã€ Propos de TecHaven",
            "footer.about_text": "Votre destination unique pour des PC, des composants et des accessoires informatiques de haute qualitÃ©. Nous nous engageons Ã  offrir les meilleures technologies et un service client exceptionnel.",
            "footer.links_title": "Liens Utiles",
            "nav.home": "Accueil",
            "nav.pc": "PCs",
            "nav.smartphones": "Smartphones",
            "nav.smartthings": "Smart Things",
            "nav.promo": "page de promo",
            "footer.my_account": "",
            "footer.contact_title": "Contactez-nous",
            "footer.copyright": "&copy; <span id='current-year'></span> TecHaven. Tous droits rÃ©servÃ©s."
        },
        en: { // Add English translations or other languages as needed
            "header.greeting": "Hello",
            "header.logout_button": "Logout",
            "header.login": "Login",
            "header.search_placeholder": "Search...",
            "header.cart": "My Cart",
            "review_page.title": "TechHaven - Submit a Review",
            "review_page.heading": "Submit Your Review",
            "review_page.intro": "We'd love to hear about your experience with TechHaven. Your feedback helps us improve!",
            "review_form.name_label": "Your Name (optional):",
            "review_form.name_placeholder": "Enter your name",
            "review_form.review_label": "Your Review (required):",
            "review_form.review_placeholder": "Share your experience...",
            "review_form.rating_label": "Your Rating:",
            "review_form.photos_label": "Add Photos (optional):",
            "review_form.submit_button": "Submit Review",
            "review_form.success_message": "Thank you for your review! Your contribution is greatly appreciated. (This is a demo. The review is not actually saved.)",
            "review_page.recent_reviews_heading": "Recent Reviews",
            "review_page.loading_reviews": "Loading reviews...",
            "review_page.no_reviews": "No reviews yet.",
            "footer.about_title": "About TecHaven",
            "footer.about_text": "Your one-stop destination for high-quality PCs, components, and computer accessories. We are committed to offering the best technology and exceptional customer service.",
            "footer.links_title": "Useful Links",
            "nav.home": "Home",
            "nav.pc": "PCs",
            "nav.smartphones": "Smartphones",
            "nav.smartthings": "Smart Things",
            "nav.promo": "Promo page",
            "footer.my_account": "My Account",
            "footer.contact_title": "Contact Us",
            "footer.copyright": "&copy; <span id='current-year'></span> TecHaven. All rights reserved."
        },
         ar: {
            "header.search_placeholder": "Ø¨Ø­Ø«...",
            "header.login": "ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„",
            "header.cart": "Ø³Ù„ØªÙŠ",
            "header.greeting": "Ù…Ø±Ø­Ø¨Ø§Ù‹",
            "header.logout_button": "ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬",
            "nav.home": "Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©",
            "nav.pc": "Ø£Ø¬Ù‡Ø²Ø© Ø§Ù„ÙƒÙ…Ø¨ÙŠÙˆØªØ±",
            "nav.smartphones": "Ø§Ù„Ù‡ÙˆØ§ØªÙ Ø§Ù„Ø°ÙƒÙŠØ©",
            "nav.smartthings": "Ø§Ù„Ø£Ø´ÙŠØ§Ø¡ Ø§Ù„Ø°ÙƒÙŠØ©",
            "nav.promo": "ØµÙØ­Ø© Ø§Ù„Ø¹Ø±ÙˆØ¶",
            "nav.contact": "Ø§ØªØµÙ„ Ø¨Ù†Ø§",
            "review_page.title": "ØªÙŠÙƒ Ù‡Ø§ÙÙ† - Ø¥Ø±Ø³Ø§Ù„ Ù…Ø±Ø§Ø¬Ø¹Ø©",
            "review_page.heading": "Ø£Ø±Ø³Ù„ Ù…Ø±Ø§Ø¬Ø¹ØªÙƒ",
            "review_page.intro": "Ù†Ø­Ù† Ù†Ø­Ø¨ Ø£Ù† Ù†Ø³Ù…Ø¹ Ø¹Ù† ØªØ¬Ø±Ø¨ØªÙƒ Ù…Ø¹ ØªÙŠÙƒ Ù‡Ø§ÙÙ†. Ù…Ù„Ø§Ø­Ø¸Ø§ØªÙƒ ØªØ³Ø§Ø¹Ø¯Ù†Ø§ Ø¹Ù„Ù‰ Ø§Ù„ØªØ­Ø³ÙŠÙ†!",
            "review_form.name_label": "Ø§Ø³Ù…Ùƒ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ):",
            "review_form.name_placeholder": "Ø£Ø¯Ø®Ù„ Ø§Ø³Ù…Ùƒ",
            "review_form.review_label": "Ù…Ø±Ø§Ø¬Ø¹ØªÙƒ (Ù…Ø·Ù„ÙˆØ¨):",
            "review_form.review_placeholder": "Ø´Ø§Ø±Ùƒ ØªØ¬Ø±Ø¨ØªÙƒ Ù‡Ù†Ø§...",
            "review_form.rating_label": "ØªÙ‚ÙŠÙŠÙ…Ùƒ:",
            "review_form.photos_label": "Ø¥Ø¶Ø§ÙØ© ØµÙˆØ± (Ø§Ø®ØªÙŠØ§Ø±ÙŠ):",
            "review_form.submit_button": "Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©",
            "review_form.success_message": "Ø´ÙƒØ±Ø§Ù‹ Ù„Ù…Ø±Ø§Ø¬Ø¹ØªÙƒ! Ù…Ø³Ø§Ù‡Ù…ØªÙƒ Ù…Ø­Ù„ ØªÙ‚Ø¯ÙŠØ± ÙƒØ¨ÙŠØ±. Ø³ØªÙƒÙˆÙ† Ù…Ø±Ø§Ø¬Ø¹ØªÙƒ Ù…Ø±Ø¦ÙŠØ© Ø¨Ø¹Ø¯ Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø©.", // Updated message
            "review_form.review_required_alert": "ÙŠØ±Ø¬Ù‰ ÙƒØªØ§Ø¨Ø© Ù…Ø±Ø§Ø¬Ø¹ØªÙƒ Ù‚Ø¨Ù„ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„.", // NEW
            "review_form.submit_error_alert": "ÙØ´Ù„ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.", // NEW
            "review_form.network_error_alert": "Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø´Ø¨ÙƒØ©. ÙŠØ±Ø¬Ù‰ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§ØªØµØ§Ù„Ùƒ Ø¨Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª.", // NEW
            "review_page.recent_reviews_heading": "Ù…Ø±Ø§Ø¬Ø¹Ø§Øª Ø­Ø¯ÙŠØ«Ø©", // NEW
            "review_page.loading_reviews": "Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø§Øª...", // NEW
            "review_page.no_approved_reviews": "Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø±Ø§Ø¬Ø¹Ø§Øª Ù…Ø¹ØªÙ…Ø¯Ø© Ø­ØªÙ‰ Ø§Ù„Ø¢Ù†.", // NEW
            "review_page.fetch_reviews_error": "Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø§Øª. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰ Ù„Ø§Ø­Ù‚Ø§Ù‹.", // NEW
            "footer.about_title": "Ø­ÙˆÙ„ ØªÙŠÙƒ Ù‡Ø§ÙÙ†",
            "footer.about_text": "ÙˆØ¬Ù‡ØªÙƒ Ø§Ù„ÙˆØ­ÙŠØ¯Ø© Ù„Ø£Ø¬Ù‡Ø²Ø© Ø§Ù„ÙƒÙ…Ø¨ÙŠÙˆØªØ± ÙˆØ§Ù„Ù…ÙƒÙˆÙ†Ø§Øª ÙˆÙ…Ù„Ø­Ù‚Ø§Øª Ø§Ù„ÙƒÙ…Ø¨ÙŠÙˆØªØ± Ø¹Ø§Ù„ÙŠØ© Ø§Ù„Ø¬ÙˆØ¯Ø©. Ù†Ø­Ù† Ù…Ù„ØªØ²Ù…ÙˆÙ† Ø¨ØªÙ‚Ø¯ÙŠÙ… Ø£ÙØ¶Ù„ Ø§Ù„ØªÙ‚Ù†ÙŠØ§Øª ÙˆØ®Ø¯Ù…Ø© Ø¹Ù…Ù„Ø§Ø¡ Ø§Ø³ØªØ«Ù†Ø§Ø¦ÙŠØ©.",
            "footer.links_title": "Ø±ÙˆØ§Ø¨Ø· Ù…ÙÙŠØ¯Ø©",
            "footer.my_account": "Ø­Ø³Ø§Ø¨ÙŠ",
            "footer.copyright": "Â© <span id=\"current-year-placeholder\"></span> ØªÙŠÙƒ Ù‡Ø§ÙÙ†. Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø©."
        },
         es: {
            "header.search_placeholder": "Buscar...",
            "header.login": "Iniciar SesiÃ³n",
            "header.cart": "Mi Carrito",
            "header.greeting": "Hola",
            "header.logout_button": "Cerrar SesiÃ³n",
            "nav.home": "Inicio",
            "nav.pc": "PC",
            "nav.smartphones": "Smartphones",
            "nav.smartthings": "Smart Things",
            "nav.promo":"PÃ¡gina de promociones",
            "nav.contact": "Contacto",
            "review_page.title": "TechHaven - Enviar ReseÃ±a",
            "review_page.heading": "EnvÃ­a tu ReseÃ±a",
            "review_page.intro": "Nos encantarÃ­a conocer tu experiencia con TechHaven. Â¡Tus comentarios nos ayudan a mejorar!",
            "review_form.name_label": "Tu Nombre (opcional):",
            "review_form.name_placeholder": "Introduce tu nombre",
            "review_form.review_label": "Tu ReseÃ±a (obligatorio):",
            "review_form.review_placeholder": "Comparte tu experiencia aquÃ­...",
            "review_form.rating_label": "Tu CalificaciÃ³n:",
            "review_form.photos_label": "AÃ±adir Fotos (opcional):",
            "review_form.submit_button": "Enviar ReseÃ±a",
            "review_form.success_message": "Â¡Gracias por tu reseÃ±a! Tu contribuciÃ³n es muy apreciada. Tu reseÃ±a serÃ¡ visible despuÃ©s de la aprobaciÃ³n.", // Updated message
            "review_form.review_required_alert": "Por favor, escribe tu reseÃ±a antes de enviarla.", // NEW
            "review_form.submit_error_alert": "Error al enviar la reseÃ±a. Por favor, intÃ©ntalo de nuevo.", // NEW
            "review_form.network_error_alert": "Ha ocurrido un error de red. Por favor, revisa tu conexiÃ³n a internet.", // NEW
            "review_page.recent_reviews_heading": "ReseÃ±as Recientes", // NEW
            "review_page.loading_reviews": "Cargando reseÃ±as...", // NEW
            "review_page.no_approved_reviews": "No hay reseÃ±as aprobadas todavÃ­a.", // NEW
            "review_page.fetch_reviews_error": "Error al cargar las reseÃ±as. Por favor, intÃ©ntalo de nuevo mÃ¡s tarde.", // NEW
            "footer.about_title": "Acerca de TechHaven",
            "footer.about_text": "Tu destino Ãºnico para PCs, componentes y accesorios informÃ¡ticos de alta calidad. Nos comprometemos a ofrecer la mejor tecnologÃ­a y un servicio al cliente excepcional.",
            "footer.links_title": "Enlaces Ãštiles",
            "footer.my_account": "Mi Cuenta",
            "footer.copyright": "Â© <span id=\"current-year-placeholder\"></span> TechHaven. Todos los derechos reservados."
        },
        de: {
            "header.search_placeholder": "Suchen...",
            "header.login": "Anmelden",
            "header.cart": "Mein Warenkorb",
            "header.greeting": "Hallo",
            "header.logout_button": "Abmelden",
            "nav.home": "Startseite",
            "nav.pc": "PCs",
            "nav.smartphones": "Smartphones",
            "nav.smartthings": "Smart Things",
            "nav.promo":"Angebotsseite",
            "nav.contact": "Kontakt",
            "review_page.title": "TechHaven - Bewertung abgeben",
            "review_page.heading": "Geben Sie Ihre Bewertung ab",
            "review_page.intro": "Wir wÃ¼rden gerne von Ihrer Erfahrung mit TechHaven hÃ¶ren. Ihr Feedback hilft uns, uns zu verbessern!",
            "review_form.name_label": "Ihr Name (optional):",
            "review_form.name_placeholder": "Geben Sie Ihren Namen ein",
            "review_form.review_label": "Ihre Bewertung (erforderlich):",
            "review_form.review_placeholder": "Teilen Sie hier Ihre Erfahrung...",
            "review_form.rating_label": "Ihre Bewertung:",
            "review_form.photos_label": "Fotos hinzufÃ¼gen (optional):",
            "review_form.submit_button": "Bewertung absenden",
            "review_form.success_message": "Vielen Dank fÃ¼r Ihre Bewertung! Ihr Beitrag wird sehr geschÃ¤tzt. Ihre Bewertung wird nach Genehmigung sichtbar sein.", // Updated message
            "review_form.review_required_alert": "Bitte schreiben Sie Ihre Bewertung, bevor Sie sie absenden.", // NEW
            "review_form.submit_error_alert": "Fehler beim Absenden der Bewertung. Bitte versuchen Sie es erneut.", // NEW
            "review_form.network_error_alert": "Es ist ein Netzwerkfehler aufgetreten. Bitte Ã¼berprÃ¼fen Sie Ihre Internetverbindung.", // NEW
            "review_page.recent_reviews_heading": "Neueste Bewertungen", // NEW
            "review_page.loading_reviews": "Bewertungen werden geladen...", // NEW
            "review_page.no_approved_reviews": "Noch keine genehmigten Bewertungen.", // NEW
            "review_page.fetch_reviews_error": "Fehler beim Laden der Bewertungen. Bitte versuchen Sie es spÃ¤ter erneut.", // NEW
            "footer.about_title": "Ãœber TechHaven",
            "footer.about_text": "Ihr One-Stop-Ziel fÃ¼r hochwertige PCs, Komponenten und ComputerzubehÃ¶r. Wir sind bestrebt, die beste Technologie und einen auÃŸergewÃ¶hnlichen Kundenservice zu bieten.",
            "footer.links_title": "NÃ¼tzliche Links",
            "footer.my_account": "Mein Konto",
            "footer.copyright": "Â© <span id=\"current-year-placeholder\"></span> TechHaven. Alle Rechte vorbehalten."
        },
         it: { // ITALIAN
            "header.search_placeholder": "Cerca...",
            "header.login": "Accedi",
            "header.cart": "Il mio carrello",
            "header.greeting": "Ciao",
            "header.logout_button": "Esci",
            "nav.home": "Home",
            "nav.pc": "PC",
            "nav.smartphones": "Smartphone",
            "nav.smartthings": "Smart Things",
            "nav.promo":"Pagina promozioni",
            "nav.contact": "Contatti",
            "review_page.title": "TechHaven - Invia una Recensione",
            "review_page.heading": "Invia la tua recensione",
            "review_page.intro": "Ci piacerebbe sentire la tua esperienza con TechHaven. Il tuo feedback ci aiuta a migliorare!",
            "review_form.name_label": "Il tuo nome (opzionale):",
            "review_form.name_placeholder": "Inserisci il tuo nome",
            "review_form.review_label": "La tua recensione (obbligatorio):",
            "review_form.review_placeholder": "Condividi qui la tua esperienza...",
            "review_form.rating_label": "Il tuo voto:",
            "review_form.photos_label": "Aggiungi foto (opzionale):",
            "review_form.submit_button": "Invia recensione",
            "review_form.success_message": "Grazie per la tua recensione! Il tuo contributo Ã¨ molto apprezzato. La tua recensione sarÃ  visibile dopo l'approvazione.", // Updated message
            "review_form.review_required_alert": "Si prega di scrivere la recensione prima di inviare.", // NEW
            "review_form.submit_error_alert": "Impossibile inviare la recensione. Riprova.", // NEW
            "review_form.network_error_alert": "Si Ã¨ verificato un errore di rete. Controlla la tua connessione internet.", // NEW
            "review_page.recent_reviews_heading": "Recensioni Recenti", // NEW
            "review_page.loading_reviews": "Caricamento recensioni...", // NEW
            "review_page.no_approved_reviews": "Nessuna recensione approvata per il momento.", // NEW
            "review_page.fetch_reviews_error": "Errore durante il caricamento delle recensioni. Riprova piÃ¹ tardi.", // NEW
            "footer.about_title": "Informazioni su TechHaven",
            "footer.about_text": "La tua destinazione unica per PC, componenti e accessori informatici di alta qualitÃ . Ci impegniamo a offrire la migliore tecnologia e un servizio clienti eccezionale.",
            "footer.links_title": "Link utili",
            "footer.my_account": "Il mio account",
            "footer.copyright": "Â© <span id=\"current-year-placeholder\"></span> TechHaven. Tutti i diritti riservati."
        },
        zh: { // CHINESE (Simplified)
            "header.search_placeholder": "æœç´¢...",
            "header.login": "ç™»å½•",
            "header.cart": "æˆ‘çš„è´­ç‰©è½¦",
            "header.greeting": "ä½ å¥½",
            "header.logout_button": "é€€å‡º",
            "nav.home": "é¦–é¡µ",
            "nav.pc": "ç”µè„‘",
            "nav.smartphones": "æ™ºèƒ½æ‰‹æœº",
            "nav.smartthings": "æ™ºèƒ½è®¾å¤‡",
            "nav.promo":"ä¿ƒé”€é¡µé¢",
            "nav.contact": "è”ç³»æˆ‘ä»¬",
            "review_page.title": "TechHaven - æäº¤è¯„è®º",
            "review_page.heading": "æäº¤æ‚¨çš„è¯„è®º",
            "review_page.intro": "æˆ‘ä»¬å¾ˆä¹æ„å¬å–æ‚¨åœ¨ TechHaven çš„ä½“éªŒã€‚æ‚¨çš„åé¦ˆæœ‰åŠ©äºæˆ‘ä»¬æ”¹è¿›ï¼",
            "review_form.name_label": "æ‚¨çš„å§“åï¼ˆå¯é€‰ï¼‰ï¼š",
            "review_form.name_placeholder": "è¾“å…¥æ‚¨çš„å§“å",
            "review_form.review_label": "æ‚¨çš„è¯„è®ºï¼ˆå¿…å¡«ï¼‰ï¼š",
            "review_form.review_placeholder": "åœ¨æ­¤åˆ†äº«æ‚¨çš„ä½“éªŒ...",
            "review_form.rating_label": "æ‚¨çš„è¯„åˆ†ï¼š",
            "review_form.photos_label": "æ·»åŠ ç…§ç‰‡ï¼ˆå¯é€‰ï¼‰ï¼š",
            "review_form.submit_button": "æäº¤è¯„è®º",
            "review_form.success_message": "æ„Ÿè°¢æ‚¨çš„è¯„è®ºï¼æ‚¨çš„è´¡çŒ®å—åˆ°é«˜åº¦èµèµã€‚æ‚¨çš„è¯„è®ºå°†åœ¨æ‰¹å‡†åå¯è§ã€‚", // Updated message
            "review_form.review_required_alert": "è¯·åœ¨æäº¤å‰ç¼–å†™è¯„è®ºã€‚", // NEW
            "review_form.submit_error_alert": "æäº¤è¯„è®ºå¤±è´¥ã€‚è¯·é‡è¯•ã€‚", // NEW
            "review_form.network_error_alert": "å‘ç”Ÿç½‘ç»œé”™è¯¯ã€‚è¯·æ£€æŸ¥æ‚¨çš„äº’è”ç½‘è¿æ¥ã€‚", // NEW
            "review_page.recent_reviews_heading": "æœ€æ–°è¯„è®º", // NEW
            "review_page.loading_reviews": "æ­£åœ¨åŠ è½½è¯„è®º...", // NEW
            "review_page.no_approved_reviews": "æš‚æ— å·²æ‰¹å‡†è¯„è®ºã€‚", // NEW
            "review_page.fetch_reviews_error": "åŠ è½½è¯„è®ºæ—¶å‡ºé”™ã€‚è¯·ç¨åå†è¯•ã€‚", // NEW
            "footer.about_title": "å…³äº TechHaven",
            "footer.about_about": "æ‚¨è´­ä¹°é«˜å“è´¨ç”µè„‘ã€ç»„ä»¶å’Œç”µè„‘é…ä»¶çš„ä¸€ç«™å¼ç›®çš„åœ°ã€‚æˆ‘ä»¬è‡´åŠ›äºæä¾›æœ€å¥½çš„æŠ€æœ¯å’Œå“è¶Šçš„å®¢æˆ·æœåŠ¡ã€‚", // Note: "about_about" should likely be "about_text"
            "footer.links_title": "æœ‰ç”¨é“¾æ¥",
            "footer.my_account": "æˆ‘çš„è´¦æˆ·",
            "footer.copyright": "Â© <span id=\"current-year-placeholder\"></span> TechHaven. ä¿ç•™æ‰€æœ‰æƒåˆ©ã€‚"
        },
        ja: {
            "header.search_placeholder": "æ¤œç´¢...",
            "header.login": "ãƒ­ã‚°ã‚¤ãƒ³",
            "header.cart": "ãƒã‚¤ã‚«ãƒ¼ãƒˆ",
            "header.greeting": "ã“ã‚“ã«ã¡ã¯",
            "header.logout_button": "ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ",
            "nav.home": "ãƒ›ãƒ¼ãƒ ",
            "nav.pc": "PC",
            "nav.smartphones": "ã‚¹ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒ³",
            "nav.smartthings": "ã‚¹ãƒãƒ¼ãƒˆãƒ‡ãƒã‚¤ã‚¹",
            "nav.promo":"ãƒ—ãƒ­ãƒ¢ãƒ¼ã‚·ãƒ§ãƒ³ãƒšãƒ¼ã‚¸",
            "nav.contact": "ãŠå•ã„åˆã‚ã›",
            "review_page.title": "TechHaven - ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’é€ä¿¡",
            "review_page.heading": "ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’é€ä¿¡",
            "review_page.intro": "TechHavenã§ã®ä½“é¨“ã‚’ãŠèã‹ã›ãã ã•ã„ã€‚çš†æ§˜ã‹ã‚‰ã®ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã¯æ”¹å–„ã«å½¹ç«‹ã¡ã¾ã™ï¼",
            "review_form.name_label": "ãŠåå‰ï¼ˆä»»æ„ï¼‰ï¼š",
            "review_form.name_placeholder": "ãŠåå‰ã‚’å…¥åŠ›",
            "review_form.review_label": "ãƒ¬ãƒ“ãƒ¥ãƒ¼ï¼ˆå¿…é ˆï¼‰ï¼š",
            "review_form.review_placeholder": "ã“ã“ã«ä½“é¨“ã‚’å…±æœ‰ã—ã¦ãã ã•ã„...",
            "review_form.rating_label": "è©•ä¾¡ï¼š",
            "review_form.photos_label": "å†™çœŸã‚’è¿½åŠ ï¼ˆä»»æ„ï¼‰ï¼š",
            "review_form.submit_button": "ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’é€ä¿¡",
            "review_form.success_message": "ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ï¼è²´é‡ãªã”æ„è¦‹ã«æ„Ÿè¬ã„ãŸã—ã¾ã™ã€‚ãƒ¬ãƒ“ãƒ¥ãƒ¼ã¯æ‰¿èªå¾Œã«è¡¨ç¤ºã•ã‚Œã¾ã™ã€‚", // Updated message
            "review_form.review_required_alert": "é€ä¿¡ã™ã‚‹å‰ã«ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’è¨˜å…¥ã—ã¦ãã ã•ã„ã€‚", // NEW
            "review_form.submit_error_alert": "ãƒ¬ãƒ“ãƒ¥ãƒ¼ã®é€ä¿¡ã«å¤±æ•—ã—ã¾ã—ãŸã€‚ã‚‚ã†ä¸€åº¦ãŠè©¦ã—ãã ã•ã„ã€‚", // NEW
            "review_form.network_error_alert": "ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆæ¥ç¶šã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚", // NEW
            "review_page.recent_reviews_heading": "æœ€è¿‘ã®ãƒ¬ãƒ“ãƒ¥ãƒ¼", // NEW
            "review_page.loading_reviews": "ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’èª­ã¿è¾¼ã¿ä¸­...", // NEW
            "review_page.no_approved_reviews": "ã¾ã æ‰¿èªã•ã‚ŒãŸãƒ¬ãƒ“ãƒ¥ãƒ¼ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚", // NEW
            "review_page.fetch_reviews_error": "ãƒ¬ãƒ“ãƒ¥ãƒ¼ã®èª­ã¿è¾¼ã¿ä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚å¾Œã§ã‚‚ã†ä¸€åº¦ãŠè©¦ã—ãã ã•ã„ã€‚", // NEW
            "footer.about_title": "TechHavenã«ã¤ã„ã¦",
            "footer.about_text": "é«˜å“è³ªãªPCã€ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã€PCã‚¢ã‚¯ã‚»ã‚µãƒªãƒ¼ã®ãƒ¯ãƒ³ã‚¹ãƒˆãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒ—ã§ã™ã€‚æœ€é«˜ã®æŠ€è¡“ã¨å„ªã‚ŒãŸé¡§å®¢ã‚µãƒ¼ãƒ“ã‚¹ã‚’æä¾›ã™ã‚‹ã“ã¨ã‚’ãŠç´„æŸã—ã¾ã™ã€‚",
            "footer.links_title": "å½¹ç«‹ã¤ãƒªãƒ³ã‚¯",
            "footer.my_account": "ãƒã‚¤ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ",
            "footer.copyright": "Â© <span id=\"current-year-placeholder\"></span> TechHaven. ç„¡æ–­è»¢è¼‰ã‚’ç¦ã˜ã¾ã™ã€‚"
        }

        // Add more languages as needed
    };

    let currentLang = localStorage.getItem('language') || 'fr'; // Get current language from localStorage or default to 'fr'

    function applyTranslations() {
        document.querySelectorAll('[data-i18n]').forEach(element => {
            const key = element.getAttribute('data-i18n');
            if (translations[currentLang] && translations[currentLang][key]) {
                element.textContent = translations[currentLang][key];
            } else if (translations['fr'] && translations['fr'][key]) { // Fallback to French if current language key is missing
                element.textContent = translations['fr'][key];
            }
        });
        document.querySelectorAll('[data-i18n-placeholder]').forEach(element => {
            const key = element.getAttribute('data-i18n-placeholder');
            if (translations[currentLang] && translations[currentLang][key]) {
                element.placeholder = translations[currentLang][key];
            } else if (translations['fr'] && translations['fr'][key]) { // Fallback to French
                element.placeholder = translations['fr'][key];
            }
        });
        updateLoginUI(currentLang); // Update dynamic login UI with current language
    }

    // Language selector logic
    const languageSelect = document.querySelector('.language-select');
    if (languageSelect) {
        languageSelect.value = currentLang; // Set initial selection
        languageSelect.addEventListener('change', (event) => {
            currentLang = event.target.value;
            localStorage.setItem('language', currentLang);
            applyTranslations(); // Re-apply translations for entire page
        });
    }

    // --- USER LOGIN/LOGOUT UI ---
    const currentUser = JSON.parse(localStorage.getItem("currentUser"));
    const userControls = document.getElementById("user-controls");

    function updateLoginUI(lang) {
        if (currentUser) {
            userControls.innerHTML = `
                <div class="icon-button">
                    <span class="icon">ğŸ‘‹</span>
                    <span class="text">${translations[lang]['header.greeting'] || translations['fr']['header.greeting']}, ${currentUser.prenom}</span>
                </div>
                <button onclick="logout()" style="
                    margin-left: 10px;
                    background-color: #ff5e5e;
                    color: white;
                    border: none;
                    padding: 6px 12px;
                    border-radius: 6px;
                    cursor: pointer;
                ">${translations[lang]['header.logout_button'] || translations['fr']['header.logout_button']}</button>
            `;
        } else {
            userControls.innerHTML = `
                <a href="login.html" class="icon-button">
                    <span class="icon">ğŸ‘¤</span>
                    <span class="text">${translations[lang]['header.login'] || translations['fr']['header.login']}</span>
                </a>
            `;
        }
    }

    function logout() {
        localStorage.removeItem("currentUser");
        localStorage.removeItem("role");
        window.location.reload();
    }

    // --- Review Form Logic ---
    const reviewForm = document.getElementById('reviewForm');
    const reviewerNameInput = document.getElementById('reviewerName');
    const reviewTextInput = document.getElementById('reviewText');
    const ratingInputs = document.querySelectorAll('input[name="rating"]');
    const reviewPhotosInput = document.getElementById('reviewPhotos');
    const fileUploadPreview = document.getElementById('fileUploadPreview');
    const successMessage = document.getElementById('successMessage');
    const reviewsListContainer = document.getElementById('reviewsListContainer');

    // Function to handle file uploads preview
    if (reviewPhotosInput && fileUploadPreview) {
        reviewPhotosInput.addEventListener('change', function() {
            fileUploadPreview.innerHTML = ''; // Clear previous previews
            if (this.files.length === 0) {
                fileUploadPreview.classList.add('empty');
            } else {
                fileUploadPreview.classList.remove('empty');
                Array.from(this.files).forEach(file => {
                    if (file.type.startsWith('image/')) {
                        const img = document.createElement('img');
                        img.src = URL.createObjectURL(file);
                        img.classList.add('review-media-thumbnail');
                        fileUploadPreview.appendChild(img);
                    }
                });
            }
        });

        // Initialize empty state if no files are selected initially
        if (reviewPhotosInput.files.length === 0) {
            fileUploadPreview.classList.add('empty');
        }
    }

    // Function to convert a File to a Data URL (Base64)
    function fileToBase64(file) {
        return new Promise((resolve, reject) => {
            const reader = new FileReader();
            reader.onload = () => resolve(reader.result);
            reader.onerror = error => reject(error);
            reader.readAsDataURL(file);
        });
    }

    // Function to fetch and display reviews from localStorage
   async function fetchAndDisplayReviewsFromBackend() {
    reviewsListContainer.innerHTML = `<p>${translations[currentLang]['review_page.loading_reviews'] || 'Chargement des avis...'}</p>`;

    try {
        const res = await fetch('http://localhost:5000/api/reviews/approved');
        const reviews = await res.json();

        reviewsListContainer.innerHTML = '';

        if (reviews.length === 0) {
            reviewsListContainer.innerHTML = `<p>${translations[currentLang]['review_page.no_reviews'] || 'Aucun avis disponible.'}</p>`;
            return;
        }

        reviews.forEach(review => {
            const reviewCard = document.createElement('div');
            reviewCard.classList.add('review-display-card');

            let starsHtml = '';
            for (let i = 0; i < 5; i++) {
                starsHtml += `<span class="star ${i < review.rating ? 'filled' : ''}">â˜…</span>`;
            }

            let mediaGalleryHtml = '';
if (review.media && review.media.length > 0) {
    mediaGalleryHtml = `<div class="review-media-gallery">
        ${review.media.map(mediaItem => `
            <img 
              src="http://localhost:5000${mediaItem.filePath}" 
              alt="media" 
              class="review-media-thumbnail"
            >`).join('')}
    </div>`;
}


            reviewCard.innerHTML = `
                <div class="reviewer-info">
                    <span class="reviewer-name">${review.reviewerName}</span>
                    <div class="review-rating">${starsHtml}</div>
                </div>
                <p class="review-text">${review.reviewText}</p>
                ${mediaGalleryHtml}
                <span class="review-date">${new Date(review.createdAt).toLocaleDateString(currentLang === 'fr' ? 'fr-FR' : 'en-US')}</span>
            `;
            reviewsListContainer.appendChild(reviewCard);
        });

    } catch (err) {
        console.error("Erreur rÃ©cupÃ©ration des avis:", err);
        reviewsListContainer.innerHTML = `<p>Erreur serveur.</p>`;
    }
}


    // Handle form submission
    reviewForm.addEventListener('submit', async function(event) {
    event.preventDefault();

    const reviewerName = reviewerNameInput.value.trim();
    const reviewText = reviewTextInput.value.trim();
    const selectedRating = document.querySelector('input[name="rating"]:checked');
    const rating = selectedRating ? parseInt(selectedRating.value) : 0;

    if (!reviewText) {
        alert('Veuillez Ã©crire votre avis avant de soumettre.');
        return;
    }

    const formData = new FormData();
    formData.append('reviewerName', reviewerName || 'Anonymous');
    formData.append('reviewText', reviewText);
    formData.append('rating', rating);

    const files = Array.from(reviewPhotosInput.files);
    for (const file of files) {
        formData.append('reviewMedia', file); // ğŸ‘ˆ Must match backend's field name
    }

    try {
        const response = await fetch('http://localhost:5000/api/reviews', {
            method: 'POST',
            body: formData
        });

        const result = await response.json();

        if (response.ok) {
            successMessage.style.display = 'block';
            setTimeout(() => successMessage.style.display = 'none', 5000);

            reviewForm.reset();
            fileUploadPreview.innerHTML = '';
            fileUploadPreview.classList.add('empty');

            // ğŸ‘‰ Load from MongoDB
            fetchAndDisplayReviewsFromBackend();
        } else {
            alert(result.message || 'Erreur lors de la soumission.');
        }

    } catch (error) {
        console.error("Erreur lors de l'envoi de l'avis :", error);
        alert("Erreur rÃ©seau ou serveur.");
    }
});


    // --- Initial Load Logic ---
    document.addEventListener('DOMContentLoaded', () => {
        applyTranslations(); // Apply translations first
        updateLoginUI(currentLang); // Then update login UI
        fetchAndDisplayReviewsFromBackend();// Load and display existing reviews
    });

    // Example for current year in footer
    const currentYearPlaceholder = document.getElementById('current-year');
    if (currentYearPlaceholder) {
        currentYearPlaceholder.textContent = new Date().getFullYear();
    }
    </script>
</body>
</html>